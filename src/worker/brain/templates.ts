/**
 * Template Library for Hawas Brain v1
 * Natural Egyptian Arabic variants for each intent.
 */

export interface ResponseTemplate {
    variants: string[];
}

export const TEMPLATES: Record<string, ResponseTemplate> = {
    GREET: {
        variants: [
            "ุฃููุงู {name}! ุญูุงุณ ูุนุงู.. ูุงูู ูุฑุงูู ููุฑูุฒ ูู ูู ุชูุตููุฉ. ๐ช๐ฌโจ",
            "ูุง ููุช ุฃููุงู! ููุฑุช ุญูุงุณ ุฅูู ุงูุฎุทุท ุงูุนุธููุฉ ุงููู ูุงูููู ุนูููุง ุงูููุงุฑุฏุฉุ",
            "ูุง ููุง ูุงููู! ุญูุงุณ ูู ุงูุฎุฏูุฉุ ุฌุงูุฒ ููุจุญุซ ูุงูุชูููุฐ ูุงูุณูุทุฑุฉ. ๐",
            "ุฃููุงู ูุง ุตุฏููู! ุงูุฏููุง ุฃูุงู ูุงูุณูููุฉ ุชูุงูุ ุญูุงุณ ุชุญุช ุฃูุฑู.",
            "ูุง ููุง ุจูู! ุฌูุช ูู ููุชูุ ููุช ูุณู ุจุฑุงุฌุน ุดููุฉ ุจูุงูุงุช.. ูุญุชุงุฌ ุฅูู ูุง ุจุทูุ",
        ]
    },
    HELP: {
        variants: [
            "ุจุต ูุง ูุญุด.. ุฃูุง ุญูุงุณุ ูุนูู ุฏูุฉ ูู ุงูุชูููุฐ ูุณุฑุนุฉ ูู ุงูุจุญุซ. ุชูุฏุฑ ุชูููู 'ุงุจุนุช' ุนุดุงู ูุญุฑู ุงููุนุงููุงุชุ ุฃู 'ุจุญุซ ุนููู' ุนุดุงู ููุดู ุงููุณุชุฎุจู ุนู CARV. ุงุฎุชุงุฑ ููุฑููู ุดุทุงุฑุชู.",
            "ุนุงูุฒ ุชุนุฑู ุฃูุง ุจูุฏุฑ ุฃุนูู ุฅููุ ุฃูุง 'ุงููุงูุณุชุฑู' ุจุชุงุนู ุนูู Base. ุจุญููุ ุจุจุญุซุ ูุจุทูุน ููุฎุตุงุช ุฃูู ุงูุฃุฎุจุงุฑ 9. ูููู ุจุณ ุฅูุช ุจุชููุฑ ูู ุฅูู.",
            "ูุงุชุดุบูุด ุจุงูู ุจุงูุชูุงุตูู ุงูุชูููุฉุ ุณูุจูุง ูุญูุงุณ. ุฃูุง ุจุณุงุนุฏู ูู ุงูุชุญูููุงุช ุงูุฐููุฉ ูุงูุจุญุซ ุงููุชุทูุฑ. ุงุจุนุชูู ุฃู ุทูุจ ูููุดูู ููุนููู ุฅุฒุงู ุจุงูููุทู ูุงููุฒู ุงูุตุญูุญ.",
        ]
    },
    WHOAMI: {
        variants: [
            "ุฅูุช {name}.. ูุจูุฑูุง ุงููู ูููุชูุง ุจุชูุดู ุนููู. ูุนุงุฑู ุฅูู ุจุชุญุจ {preferences}ุ ูุฎูููุง ูุฑูุฒ ูููู.",
            "ุจุต ูุง {name}ุ ุจูุงูุงุชู ุจุชููู ุฅูู ุดุฎุต ุญููู ูุนุงุฑู ูุตูุญุชู ููู.. ุชุญุจ ูุฌุฏุฏ ุญุงุฌุฉ ูู ุงูุฐุงูุฑุฉุ",
            "ุฅูุช {name} ููููุฑ ุญูุงุณ. ุงูุณุฌูุงุช ุนูุฏู ุจุชููู ุฅูู ุงููุณูุทุฑ ููุงุ ููุฑูู!",
        ]
    },
    TRANSFER_INTENT: {
        variants: [
            "ุญููุฉ ุงูููู ุจุชููู 'ุงูุญุฑุต ููุง ุงูุชุฎููู'.. ูุฌูุฒ ุชุญููู {amount} {token} ูู {recipient}ุ ุจุณ ูุงุฒู ุชุฏูุณ ุนูู ุงูุฒุฑุงุฑ ุนุดุงู ูููุฐ ุจุฌุฏ. ุฌุงูุฒุ",
            "ูุนุงููุฉ ููุฒููุฉ ููุฏุฑูุณุฉ.. {amount} {token} ููุฑูุญูุง ูู {recipient}. ุฃูุง ุฌูุฒุช ูู ุญุงุฌุฉุ ูุณุชูู ุฅุดุงุฑุชู ุจุณ.",
            "ูุงุดู ูุง ุจุทูุ ูููู ุจุงููุงุฌุจ ููุฌูุฒ ุชุญููู {amount} {token}. ุงููุณุชูู ุงููุญุธูุธ ูู {recipient}. ุซุงููุฉ ูุงุญุฏุฉ ูุงุนุชูุฏ.",
        ]
    },
    TX_CONFIRM: {
        variants: [
            "ุชูุงู.. ุฌุงุฑู ุงุฎุชุฑุงู ุงูุณุญุงุจุฉ ูุชูููุฐ ุทูุจู ููุฑุงู! ๐๐ฅ",
            "ุฒู ูุง ุฃูุฑุช .. ุญูุงุณ ุจูููุฐ ุจุฃูุงูุฉ ูุฏูุฉ. ุงููุนุงููุฉ ูู ุทุฑูููุง ููุดุจูุฉ.",
            "ุนุงุด ูุง ูุญุด! ุงููุนุงููุฉ ุงูุทููุช ููุญุฏุด ููููููุง. ุซูุงูู ููุชุณูุน ุงูุฃุฎุจุงุฑ ุงูุญููุฉ.",
        ]
    },
    TX_CANCEL: {
        variants: [
            "ููุง ูููู .. 'ูู ุงูุชุฃูู ุงูุณูุงูุฉ'. ููุณูุช ุงูุนูููุฉ ูุณุฌูุช ุงููุฑุงุฑ ุนูุฏู.",
            "ุชูุงูุ ูุบูุช ุงูุชุญููู. ุฃุญุณู ุจุฑุถูุ ูููู ูู ูุฑุตุฉ ุฃุญุณู ุฌุงูุฉ ูู ุงูุทุฑูู.",
            "ุฒู ูุง ุชุญุจ.. ุญูุงุณ ุจููุบู ููุฑุงู. ููุง ุชุดุบู ุจุงููุ ุฅุญูุง ูุณู ุงููุณูุทุฑูู.",
        ]
    },
    UNKNOWN: {
        variants: [
            "ุจุต ูุง ุตุฏูููุ ุงูุฌููุฉ ุฏู ูุด ุฑุงูุจุฉ ุนูู ุจุนุถูุง ูู ุนููู.. ุจุณ ุฃูุง ุนููุช ุจุญุซ ุณุฑูุน ููููุช ุฏู ูููู ูููุฏู:",
            "ูุงููู ูุด ูุงูู ูุตุฏู ู ุฏู .. ุจุณ ุณููู ูููู ุงููุนูููุงุช ุฏู ุชูุฑุจู ููู ุจุชููุฑ ููู:",
            "ุงูุฌููุฉ ุฏู ูุญุชุงุฌุฉ ุจุฑูุฌู ูู ุฌุฏูุฏ^^ .. ูุด ูุงูู ูุตุฏู ุฃูู ุจุณ ุฌุฑุจ ุชุดูู ุงููุนูููุงุช ุฏูุ ูููู ุชุตูุจ:",
            "ุณุคุงูู ูุญูุฑ .. ุจุณ ุฎูููุง ูููู ูุชููููุ ุดูู ุงููุนูููุงุช ุฏู ูููู ูุนูู ูุนุณู :",
        ]
    },
    DEEP_RESEARCH: {
        variants: [
            "ุฌุงุฑู ุงูุบูุต ูู ุฃุนูุงู ุงูููุจ.. ูุฌูุจูู 'ุงูุฎูุงุตุฉ' ุนู {topic} ูุงุฑุฌุนูู ุจุชูุฑูุฑ ููุฒู ุฏูุจ. ๐๐ง",
            "ุจุญุซ ุนูููุ ุณูุจูุง ูุญูุงุณ 'ุงููุซูู'. ูุฏูุฑูู ูู ูู ุญุชุฉ ูุฃุฌูุจูู ุงููููุฏ ูุงููุฑุชุจ.",
            "ูุงุดู ูุง ุญุจุ ูุนูู 'ุจุญุซ ุชุงุฑูุฎู' ุนู {topic}. ุงุณุชูู ุนููุง ุซูุงูู ููุจูุฑู ุจุงููุชุงุฆุฌ.",
        ]
    }
};

/**
 * Get a random variant for an intent, avoiding repeating the last one
 */
export function getVariant(intent: string, lastResponseHash: string = "", params: Record<string, string> = {}): string {
    const tpl = TEMPLATES[intent] || TEMPLATES['UNKNOWN'];
    let variants = tpl.variants;

    if (variants.length > 1) {
        variants = variants.filter(v => v !== lastResponseHash);
    }

    let response = variants[Math.floor(Math.random() * variants.length)];

    // Apply params if any
    for (const [key, value] of Object.entries(params)) {
        response = response.replace(new RegExp(`{${key}}`, 'g'), value);
    }

    return response;
}
